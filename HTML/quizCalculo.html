<!DOCTYPE html>
<html lang="es" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Técnica de integración - Nexo Ciencia</title>
    <link rel="stylesheet" href="../CSS/base.css">
    <link rel="stylesheet" href="../CSS/mecanica.css">
    <link rel="stylesheet" href="../CSS/theme.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="../JS/utilidades.js"></script>
    <script src="../JS/auth.js"></script>
    <script src="../JS/icono.js"></script>
    <script src="../JS/calculoProgreso.js"></script>
    <script src="../JS/theme.js"></script>
</head>

<body>
    <!-- Navegación -->
    <nav class="nav">
        <div class="nav-left">
            <a href="menu.html" class="btn-back" title="Volver al menú">
                <i class="fas fa-arrow-left"></i>
                <span>Volver al Menú</span>
            </a>
            <a href="../index.html" class="nav-logo">
                <img src="../Recursos/Imagenes/NEXO CIENCIA.svg" alt="Nexo Ciencia" style="width: 110px;">
            </a>
        </div>
        <div class="user-menu">
            <button class="theme-toggle" id="theme-toggle" title="Cambiar tema">
                <i class="fas fa-sun"></i>
            </button>
            <a href="usuario.html" title="Ir al panel de usuario">
                <img id="user-avatar" src="https://cdn-icons-png.flaticon.com/512/2922/2922506.png" alt="Avatar de usuario" class="user-avatar">
            </a>
        </div>
    </nav>

    <div class="course-container">
        <div class="course-header">
            <h1>
                <i class="fas fa-integral"></i>
                Técnica de integración
            </h1>
            <p>Domina las diferentes técnicas de integración y sus aplicaciones</p>
        </div>

        <div class="topics-grid">
            <!-- Tema 1: Sustitución -->
            <div class="topic-card">
                <div class="topic-header">
                    <i class="fas fa-exchange-alt"></i>
                    <h2>Sustitución</h2>
                    <span class="topic-badge">Nivel 1</span>
                </div>
                <p class="topic-description">
                    Aprende a resolver integrales mediante el método de sustitución de variables.
                </p>
                <div class="level-buttons">
                    <div class="button-platform">
                        <button onclick="window.location.href='botoCalculo-1-1.html'" class="level-btn" data-level="1.1">
                            <span class="level-number">1.1</span>
                            <span class="level-status"><i class="fas fa-check-circle"></i></span>
                        </button>
                    </div>
                    <div class="button-platform">
                        <div class="button-group">
                            <button onclick="window.location.href='botoCalculo-1-2.html'" class="level-btn" data-level="1.2">
                                <span class="level-number">1.2</span>
                                <span class="level-status"><i class="fas fa-check-circle"></i></span>
                            </button>
                            <button onclick="window.location.href='botoCalculo-1-3.html'" class="level-btn" data-level="1.3">
                                <span class="level-number">1.3</span>
                                <span class="level-status"><i class="fas fa-check-circle"></i></span>
                            </button>
                        </div>
                    </div>
                    <div class="button-platform">
                        <button onclick="window.location.href='botoCalculo-1-4.html'" class="level-btn" data-level="1.4">
                            <span class="level-number">1.4</span>
                            <span class="level-status"><i class="fas fa-lock"></i></span>
                        </button>
                    </div>
                </div>
                <div class="topic-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                    <span class="progress-text">0% completado</span>
                </div>
            </div>

            <!-- Tema 2: Por partes -->
            <div class="topic-card">
                <div class="topic-header">
                    <i class="fas fa-puzzle-piece"></i>
                    <h2>Por partes</h2>
                    <span class="topic-badge">Nivel 2</span>
                </div>
                <p class="topic-description">
                    Domina la técnica de integración por partes y sus aplicaciones en diferentes tipos de funciones.
                </p>
                <div class="level-buttons">
                    <div class="button-platform">
                        <button onclick="window.location.href='botoCalculo-2-1.html'" class="level-btn" data-level="2.1">
                            <span class="level-number">2.1</span>
                            <span class="level-status"><i class="fas fa-lock"></i></span>
                        </button>
                    </div>
                    <div class="button-platform">
                        <div class="button-group">
                            <button onclick="window.location.href='botoCalculo-2-2.html'" class="level-btn" data-level="2.2">
                                <span class="level-number">2.2</span>
                                <span class="level-status"><i class="fas fa-lock"></i></span>
                            </button>
                            <button onclick="window.location.href='botoCalculo-2-3.html'" class="level-btn" data-level="2.3">
                                <span class="level-number">2.3</span>
                                <span class="level-status"><i class="fas fa-lock"></i></span>
                            </button>
                        </div>
                    </div>
                    <div class="button-platform">
                        <button onclick="window.location.href='botoCalculo-2-4.html'" class="level-btn" data-level="2.4">
                            <span class="level-number">2.4</span>
                            <span class="level-status"><i class="fas fa-lock"></i></span>
                        </button>
                    </div>
                </div>
                <div class="topic-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                    <span class="progress-text">0% completado</span>
                </div>
            </div>

            <!-- Tema 3: Fracciones racionales -->
            <div class="topic-card">
                <div class="topic-header">
                    <i class="fas fa-divide"></i>
                    <h2>Fracciones racionales</h2>
                    <span class="topic-badge">Nivel 3</span>
                </div>
                <p class="topic-description">
                    Aprende a integrar fracciones racionales mediante descomposición en fracciones parciales.
                </p>
                <div class="level-buttons">
                    <div class="button-platform">
                        <button onclick="window.location.href='botoCalculo-3-1.html'" class="level-btn" data-level="3.1">
                            <span class="level-number">3.1</span>
                            <span class="level-status"><i class="fas fa-lock"></i></span>
                        </button>
                    </div>
                    <div class="button-platform">
                        <div class="button-group">
                            <button onclick="window.location.href='botoCalculo-3-2.html'" class="level-btn" data-level="3.2">
                                <span class="level-number">3.2</span>
                                <span class="level-status"><i class="fas fa-lock"></i></span>
                            </button>
                            <button onclick="window.location.href='botoCalculo-3-3.html'" class="level-btn" data-level="3.3">
                                <span class="level-number">3.3</span>
                                <span class="level-status"><i class="fas fa-lock"></i></span>
                            </button>
                        </div>
                    </div>
                    <div class="button-platform">
                        <button onclick="window.location.href='botoCalculo-3-4.html'" class="level-btn" data-level="3.4">
                            <span class="level-number">3.4</span>
                            <span class="level-status"><i class="fas fa-lock"></i></span>
                        </button>
                    </div>
                </div>
                <div class="topic-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
        </div>
                    <span class="progress-text">0% completado</span>
        </div>
        </div>

            <!-- Tema 4: Avanzadas -->
            <div class="topic-card">
                <div class="topic-header">
                    <i class="fas fa-brain"></i>
                    <h2>Avanzadas</h2>
                    <span class="topic-badge">Nivel 4</span>
                </div>
                <p class="topic-description">
                    Resuelve integrales complejas combinando diferentes técnicas de integración.
                </p>
                <div class="level-buttons">
                    <div class="button-platform">
                        <button onclick="window.location.href='botoCalculo-4-1.html'" class="level-btn" data-level="4.1">
                            <span class="level-number">4.1</span>
                            <span class="level-status"><i class="fas fa-lock"></i></span>
                        </button>
                    </div>
                    <div class="button-platform">
                        <div class="button-group">
                            <button onclick="window.location.href='botoCalculo-4-2.html'" class="level-btn" data-level="4.2">
                                <span class="level-number">4.2</span>
                                <span class="level-status"><i class="fas fa-lock"></i></span>
                            </button>
                            <button onclick="window.location.href='botoCalculo-4-3.html'" class="level-btn" data-level="4.3">
                                <span class="level-number">4.3</span>
                                <span class="level-status"><i class="fas fa-lock"></i></span>
                            </button>
                        </div>
                    </div>
                    <div class="button-platform">
                        <button onclick="window.location.href='botoCalculo-4-4.html'" class="level-btn" data-level="4.4">
                            <span class="level-number">4.4</span>
                            <span class="level-status"><i class="fas fa-lock"></i></span>
                        </button>
                    </div>
                </div>
                <div class="topic-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                    <span class="progress-text">0% completado</span>
                </div>
        </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            checkSession(true);
            insertarLogo();
            actualizarEstadoBotones();
            actualizarFotoPerfil();
            inicializarTema();
            inicializarProgresoCalculo();
            actualizarInterfazProgresoCalculo();
        });

        // Función para verificar y actualizar el estado de los botones
        function actualizarEstadoBotones() {
            const botones = document.querySelectorAll('.level-btn');

            botones.forEach(button => {
                    const nivel = button.getAttribute('data-level');
                if (!verificarNivelDesbloqueadoCalculo(nivel)) {
                    button.disabled = true;
                        button.classList.add('locked');
                } else {
                    button.disabled = false;
                    button.classList.remove('locked');
                    }
                });
        }

        function actualizarProgresoTemas() {
            const temas = {
                1: [1.1, 1.2, 1.3, 1.4],
                2: [2.1, 2.2, 2.3, 2.4],
                3: [3.1, 3.2, 3.3, 3.4],
                4: [4.1, 4.2, 4.3, 4.4]
            };

            const sesion = JSON.parse(localStorage.getItem('sesion'));
            const userName = sesion[0].userName || sesion[0].correo;

            Object.entries(temas).forEach(([tema, niveles]) => {
                let completados = 0;
                niveles.forEach(nivel => {
                    const nivelData = JSON.parse(localStorage.getItem(`${userName}_nivel ${nivel}`) || '{}');
                    if (nivelData.completado) completados++;
                });

                const porcentaje = (completados / niveles.length) * 100;
                const topicCard = document.querySelector(`.topic-card:nth-child(${tema})`);
                if (topicCard) {
                    const progressFill = topicCard.querySelector('.progress-fill');
                    const progressText = topicCard.querySelector('.progress-text');
                    progressFill.style.width = `${porcentaje}%`;
                    progressText.textContent = `${Math.round(porcentaje)}% completado`;
                }
            });
        }

        function actualizarFotoPerfil() {
            const sesion = JSON.parse(localStorage.getItem('sesion'));
            if (sesion && sesion.length > 0 && sesion[0].foto) {
                const userAvatar = document.getElementById('user-avatar');
                userAvatar.src = sesion[0].foto;
            }
        }

        // Funciones para el manejo del tema
        function inicializarTema() {
            const themeToggle = document.getElementById('theme-toggle');
            const savedTheme = localStorage.getItem('theme') || 'light';

            document.documentElement.setAttribute('data-theme', savedTheme);
            actualizarIconoTema(savedTheme);

            themeToggle.addEventListener('click', () => {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';

                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                actualizarIconoTema(newTheme);
            });
        }

        function actualizarIconoTema(theme) {
            const themeIcon = document.querySelector('#theme-toggle i');
            if (theme === 'dark') {
                themeIcon.className = 'fas fa-moon';
            } else {
                themeIcon.className = 'fas fa-sun';
            }
        }
    </script>
</body>

</html>